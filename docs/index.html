<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deficiency Decision Tool (POC)</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>

  <!-- Header (NO wizard nav buttons here anymore) -->
  <header class="app-header">
    <div class="app-title">
      <h1>Deficiency Decision Tool (POC)</h1>
      <div class="sub">Question-based wizard (flow pack), pinned notes/directives, manual tabs, and document generation.</div>
    </div>

    <div class="app-controls">
      <div class="control">
        <div>Start Pack</div>
        <select id="packSelect">
          <option value="figure1" selected>Figure 1 — Classification</option>
          <option value="figure2">Figure 2 — Failure Type</option>
        </select>
      </div>


      <!-- Optional debug toggle via ?debug=1 still works -->
    </div>
  </header>

  <!-- Main layout -->
  <main class="layout-single">

    <!-- LEFT COLUMN: Tabs (Manual) vs (Wizard + Notes) -->
    <section class="left-stack">

      <!-- LEFT TABS HEADER -->
      <div class="card left-tabs">
        <div class="panel-head">
          <div>
            <h2>Workspace</h2>
            <div class="panel-sub muted">Switching tabs does not reset wizard position.</div>
          </div>

          <div class="tabs" role="tablist" aria-label="Left Tabs">
            <button class="tab-btn active" id="tabLeftWizard" type="button" role="tab" aria-selected="true">Wizard + Notes</button>
            <button class="tab-btn" id="tabLeftManual" type="button" role="tab" aria-selected="false">Manual</button>
          </div>
        </div>

        <!-- TAB: WIZARD + NOTES -->
        <div id="leftWizardWrap" class="left-tab-body">

          <!-- FLOW (Wizard) -->
          <div class="card flow">
            <div class="panel-head">
              <div>
                <h2>Flow Diagram</h2>
                <div class="panel-sub" id="flowMeta">Pack: - | Step: -</div>
              </div>
              <div class="panel-right muted">Wizard</div>
            </div>

            <div id="screen" class="screen"></div>

            <!-- Wizard footer controls are HERE -->
            <div class="nav wizard-nav">
              <div class="nav-left">
                <button class="btn secondary danger-outline" id="btnStartOver" type="button">Start Over</button>
                <button class="btn secondary" id="btnReset" type="button">Reset</button>
              </div>
              <div class="nav-right">
                <button class="btn secondary" id="btnBack" type="button" disabled>Back</button>
              </div>
            </div>
          </div>

          <!-- NOTES (Pinned to node) -->
          <div class="card notes">
            <div class="notes-head">
              <div>
                <h2>Notes / Directives</h2>
                <div class="notes-sub" id="notesMeta">Pack: - | Step: -</div>
              </div>
              <div class="notes-sub">Pinned to current node</div>
            </div>
            <div class="notes-body" id="notesBody"></div>
          </div>
        </div>

        <!-- TAB: MANUAL -->
        <div id="leftManualWrap" class="left-tab-body" hidden>
          <div class="card manual">
            <div class="manual-head">
              <div>
                <h2>Manual</h2>
                <div class="manual-sub" id="manualStatus">Loading…</div>
              </div>

              <div class="tabs" role="tablist" aria-label="Manual Tabs">
                <button class="tab-btn active" id="tabManualFront" type="button" role="tab" aria-selected="true">Front Matter</button>
                <button class="tab-btn" id="tabManualReport" type="button" role="tab" aria-selected="false">Report</button>
              </div>
            </div>

            <div class="manual-body">
              <div id="manualBody" class="manual-html"></div>

              <div id="manualReportWrap" class="manual-html" hidden>
                <iframe class="manual-frame" src="./manual/report.html" title="Manual Report"></iframe>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- RIGHT COLUMN: Document Generation -->
    <section class="right-docs card">
      <div class="panel-head">
        <div>
          <h2>Document Generation</h2>
          <div class="panel-sub" id="docMeta">Event Workspace (single-page)</div>
        </div>

        <div class="tabs" role="tablist" aria-label="Document Tabs">
          <button class="tab-btn active" id="tabDocBlue" type="button" role="tab" aria-selected="true">Blue Sheet</button>
          <button class="tab-btn" id="tabDocOpcon" type="button" role="tab" aria-selected="false">OPCON</button>
          <button class="tab-btn" id="tabDocTacon" type="button" role="tab" aria-selected="false">TACON</button>
        </div>
      </div>

      <div id="docBlueWrap" class="doc-body">
        <iframe
          id="blueSheetFrame"
          class="doc-frame"
          src="./blue-sheet-demo.html"
          title="Blue Sheet Builder">
        </iframe>
      </div>

      <div id="docOpconWrap" class="doc-body" hidden>
        <div class="doc-placeholder">
          <div class="node-type">placeholder</div>
          <h3 class="h-title">OPCON generation (next)</h3>
          <div class="body">This panel will host the OPCON builder for a test event. The shell is ready.</div>
        </div>
      </div>

      <div id="docTaconWrap" class="doc-body" hidden>
        <div class="doc-placeholder">
          <div class="node-type">placeholder</div>
          <h3 class="h-title">TACON generation (next)</h3>
          <div class="body">This panel will host the TACON builder for a test event. The shell is ready.</div>
        </div>
      </div>

      <div class="app-footer">
        <div class="small">
          This interface is single-page: switching panels does not unload flow state or document drafts.
          Use <code>?debug=1</code> to display trace.
        </div>
        <div id="debugTraceWrap" class="debug-wrap" hidden>
          <div class="debug-head">
            <h2>Debug Trace</h2>
            <div class="debug-sub" id="traceMeta">-</div>
          </div>
          <pre id="trace" class="trace"></pre>
        </div>
      </div>
    </section>

  </main>

  <script src="./js/app.js"></script>
</body>
</html>
